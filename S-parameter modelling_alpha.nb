(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65776,       1406]
NotebookOptionsPosition[     62780,       1364]
NotebookOutlinePosition[     63152,       1380]
CellTagsIndexPosition[     63109,       1377]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7795391314485426`*^9, 3.7795391333542786`*^9}, {
  3.781065836157527*^9, 3.781065862885215*^9}, {3.7940681706811943`*^9, 
  3.794068173761428*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"1aaf5956-f22c-429a-804b-9e7473360dfa"],

Cell["\<\
Use \[OpenCurlyDoubleQuote]matching-tuning capacitor model\
\[CloseCurlyDoubleQuote], first define physical constants related to \
classical electrodynamics and the geometries of the cavity, calculate \
equivalent inductance of the cavity:\
\>", "Text",
 CellChangeTimes->{{3.7809313066110497`*^9, 
  3.7809313929388256`*^9}},ExpressionUUID->"2c249f65-39f2-4720-90d4-\
95848134f364"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]0", " ", "=", " ", "8.854*^-12"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rr", " ", "=", " ", "1.2*^-2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rB", " ", "=", " ", 
   RowBox[{"0.8", "*", "1.2*^-2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rT", " ", "=", " ", 
   RowBox[{"0.3", "*", "1.2*^-2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thick", " ", "=", " ", "5*^-3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sT", " ", "=", " ", 
   RowBox[{"\[Pi]", "*", 
    RowBox[{"rT", "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gap", " ", "=", " ", "0.2*^-3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f0", " ", "=", " ", "3.6*^9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", " ", "=", " ", 
   RowBox[{"\[Epsilon]0", "*", 
    RowBox[{"sT", "/", "gap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ffac", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "2*^-3", ")"}], "^", "3"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Pi]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"rr", "^", "2"}], "*", "thick"}], "-", 
        RowBox[{
         RowBox[{"1", "/", "3"}], "*", 
         RowBox[{"rB", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{"thick", "-", 
           RowBox[{
            RowBox[{"gap", "^", "3"}], "/", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"thick", "+", "gap"}], ")"}], "^", "2"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zc2", "=", " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", "c2"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l2", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "cpl_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.0", "+", 
      RowBox[{"cpl", "*", 
       RowBox[{"(", 
        RowBox[{"x1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "x2"}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f0", "^", "2"}], "*", "c2"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zl2", "[", 
    RowBox[{"y1_", ",", "y2_", ",", "cpl1_"}], "]"}], " ", ":=", " ", 
   RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", 
    RowBox[{"l2", "[", 
     RowBox[{"y1", ",", "y2", ",", "cpl1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qFactor", " ", "=", " ", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zr2", " ", "=", " ", 
   RowBox[{"f0", "*", 
    RowBox[{
     RowBox[{"l2", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}], "/", "qFactor"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7795387181260705`*^9, 3.779538768790862*^9}, {
   3.779538818690485*^9, 3.7795388207844763`*^9}, 3.7795390816065483`*^9, {
   3.779539962819764*^9, 3.7795400302095375`*^9}, 3.7795403964932404`*^9, {
   3.7795405840826592`*^9, 3.7795405909186096`*^9}, 3.7795406296112185`*^9, {
   3.779540667253701*^9, 3.779540674372163*^9}, {3.7795407241050215`*^9, 
   3.779540735614699*^9}, {3.7796350490413675`*^9, 3.779635107049444*^9}, {
   3.779693726717596*^9, 3.779693738682993*^9}, {3.779693940206124*^9, 
   3.77969395083187*^9}, {3.7796991506493983`*^9, 3.779699152773905*^9}, {
   3.7796992209751177`*^9, 3.779699223036314*^9}, {3.7796994759268503`*^9, 
   3.779699492268897*^9}, {3.7796995226884937`*^9, 3.7796995228602576`*^9}, {
   3.779699586696452*^9, 3.7796995923516493`*^9}, {3.7796996254093404`*^9, 
   3.7796996279245095`*^9}, 3.779699675433708*^9, 3.7796997227871456`*^9, {
   3.7797001814683905`*^9, 3.779700207767733*^9}, {3.7797021329537764`*^9, 
   3.7797021584907503`*^9}, {3.779702635061036*^9, 3.7797026571026893`*^9}, {
   3.7797027671767063`*^9, 3.77970277251114*^9}, {3.779702870760971*^9, 
   3.779702890027178*^9}, {3.7797050131207056`*^9, 3.779705015989496*^9}, {
   3.7797072907270746`*^9, 3.779707424885255*^9}, {3.7797081528972845`*^9, 
   3.779708202402908*^9}, {3.779708632240508*^9, 3.7797088788772697`*^9}, {
   3.7797090117200527`*^9, 3.7797090165165086`*^9}, {3.779709061495973*^9, 
   3.7797090818393955`*^9}, {3.7797091146283927`*^9, 3.779709169734738*^9}, {
   3.7798140519293995`*^9, 3.77981405723884*^9}, {3.7798838399704933`*^9, 
   3.7798838407886806`*^9}, {3.7798843609397717`*^9, 3.7798843783794284`*^9}, 
   3.7798845382917085`*^9, {3.7798847039935527`*^9, 3.7798847109540033`*^9}, {
   3.779885938841481*^9, 3.7798859539679976`*^9}, {3.779886221496276*^9, 
   3.779886221683732*^9}, {3.7809312222483034`*^9, 3.7809312387509565`*^9}, {
   3.781025821575555*^9, 3.781025822264413*^9}, {3.7811159586229553`*^9, 
   3.781115989426345*^9}, {3.781117099985097*^9, 3.781117100272439*^9}, {
   3.78111721375636*^9, 3.781117229834676*^9}, {3.781117360451848*^9, 
   3.78111736262253*^9}, {3.781117463001523*^9, 3.781117464448634*^9}, {
   3.781117556977036*^9, 3.781117577007465*^9}, {3.781117623947053*^9, 
   3.781117624349511*^9}, {3.781117721894965*^9, 3.781117749496723*^9}, {
   3.7812553205475864`*^9, 3.7812553207859464`*^9}, 3.7812556600569124`*^9, {
   3.781257452336485*^9, 3.7812574523374543`*^9}, {3.781332244811798*^9, 
   3.7813322450617447`*^9}, {3.78135603852234*^9, 3.7813560393162127`*^9}, {
   3.781356314319672*^9, 3.781356314560073*^9}, {3.7813565179396486`*^9, 
   3.7813565180713167`*^9}, {3.7813566288711824`*^9, 
   3.7813566292801285`*^9}, {3.7816368323249273`*^9, 
   3.7816368326496572`*^9}, {3.794065671713837*^9, 3.794065672113675*^9}, {
   3.7940669470674515`*^9, 3.7940669771171303`*^9}, {3.7940677634032164`*^9, 
   3.794067800250483*^9}, {3.7940678374446464`*^9, 3.7940678403557067`*^9}, {
   3.7940678865977974`*^9, 3.794067902351533*^9}, 3.7940680727288437`*^9, {
   3.7940681479824*^9, 3.7940681618566513`*^9}, {3.794069260038305*^9, 
   3.7940692603588514`*^9}, {3.7940698092495823`*^9, 
   3.7940698095786357`*^9}, {3.794069949151936*^9, 3.7940699496116867`*^9}, {
   3.7940706434235697`*^9, 3.7940706450626955`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d7e8d268-3215-4708-8398-92dd7f713a75"],

Cell["\<\
Then define the equivalent circuit of the generator and transmission line (50 \
Ohm real impedance assumed):\
\>", "Text",
 CellChangeTimes->{{3.780931397171652*^9, 3.7809314667898808`*^9}, 
   3.7809400779123244`*^9, {3.7940680814279337`*^9, 
   3.794068093196218*^9}},ExpressionUUID->"a9c5f9d1-0a41-4009-92d6-\
467f5c98d2ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zr1", " ", "=", " ", "50"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zc1", "=", " ", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", "c2"}], ")"}]}]}], ";"}],
   " "}]}], "Input",
 CellChangeTimes->{{3.7795367642536383`*^9, 3.779536813772214*^9}, {
   3.7795368628917933`*^9, 3.7795368909909134`*^9}, {3.779536950270057*^9, 
   3.7795369723777823`*^9}, {3.7795475234643373`*^9, 3.779547530166587*^9}, {
   3.779547774608503*^9, 3.779547794393914*^9}, {3.7795485020321875`*^9, 
   3.7795485167412977`*^9}, {3.7795486121477804`*^9, 
   3.7795486673542023`*^9}, {3.779548750161268*^9, 3.77954875195842*^9}, {
   3.7795493392490435`*^9, 3.7795493457409797`*^9}, {3.7795497125901423`*^9, 
   3.7795497146364846`*^9}, {3.7795506344962587`*^9, 
   3.7795506598060846`*^9}, {3.7795507140270777`*^9, 
   3.7795507666424828`*^9}, {3.7795510291104116`*^9, 3.779551036213072*^9}, {
   3.779551099194353*^9, 3.7795511342274446`*^9}, 3.779551166718891*^9, {
   3.7795512137238665`*^9, 3.779551222783886*^9}, {3.7795514683602004`*^9, 
   3.7795514688912554`*^9}, {3.7795518284149733`*^9, 
   3.7795518434877214`*^9}, {3.779552066048732*^9, 3.779552070297738*^9}, {
   3.779616174538703*^9, 3.7796161748979893`*^9}, {3.7796165488350635`*^9, 
   3.7796165516788683`*^9}, {3.779627011378837*^9, 3.77962701650253*^9}, {
   3.7796344956486917`*^9, 3.779634496259034*^9}, {3.7796351641983943`*^9, 
   3.779635165526022*^9}, {3.7796937100893106`*^9, 3.7796937108078833`*^9}, {
   3.779693874930888*^9, 3.7796938949301615`*^9}, {3.779693928848674*^9, 
   3.7796939290993185`*^9}, {3.7796945912809715`*^9, 3.77969459170317*^9}, {
   3.779702267359365*^9, 3.7797022813633685`*^9}, 3.7797029365409*^9, {
   3.7798845114534397`*^9, 3.779884514925891*^9}, {3.779884585599984*^9, 
   3.779884588922945*^9}, {3.7799561945434136`*^9, 3.779956194902725*^9}, {
   3.7799563438914337`*^9, 3.779956344204443*^9}, {3.7809312222483034`*^9, 
   3.7809312387509565`*^9}, {3.781116000887388*^9, 3.7811160028265953`*^9}, {
   3.7812561885065002`*^9, 3.781256192636422*^9}, {3.7812562677688665`*^9, 
   3.7812562703948717`*^9}, 3.7813576157700415`*^9, {3.78135769229316*^9, 
   3.7813577285786533`*^9}, {3.781636868602899*^9, 3.781636870150099*^9}, {
   3.7940673537303147`*^9, 3.7940673543497033`*^9}, {3.794069110804428*^9, 
   3.794069115502075*^9}, 3.7940701390372286`*^9, {3.7940707802804937`*^9, 
   3.7940707933229866`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",
 CellLabel->"In[16]:=",ExpressionUUID->"a0d4ad8a-1959-43b3-8a4e-ed7483be9e23"],

Cell["\<\
Define functions to be used to calculate impedance in parallel and series:\
\>", "Text",
 CellChangeTimes->{{3.7809316639859657`*^9, 3.780931685609006*^9}, {
  3.794591423663453*^9, 
  3.7945914248570337`*^9}},ExpressionUUID->"4ca677c2-df57-43bc-829c-\
35d48b2b858b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"parall", " ", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", "a"}], "+", 
      RowBox[{"1", "/", "b"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"serial", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"a", " ", "+", " ", "b"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.779551352061119*^9, 3.7795513912314615`*^9}, {
  3.7795514709213543`*^9, 3.7795514865892286`*^9}, {3.7797002622828007`*^9, 
  3.779700365829774*^9}, {3.7797004752152348`*^9, 3.7797005069048305`*^9}, {
  3.7797006132053576`*^9, 3.7797006329677916`*^9}, {3.7797018925462885`*^9, 
  3.779701893697219*^9}, {3.779702108850853*^9, 3.779702110488266*^9}, {
  3.779702240589389*^9, 3.7797022420981445`*^9}, {3.7809312222483034`*^9, 
  3.7809312387509565`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b8c419ec-bd6d-4d5c-ae2b-cbb7c2f853d9"],

Cell[TextData[{
 StyleBox["Option 1",
  FontColor->RGBColor[1, 0, 0]],
 ": Define the equivalent circuit of the sample, use capacitor to tune \
susceptibilities, and a transformer model to couple the sample to cavity:"
}], "Text",
 CellChangeTimes->{{3.780931474725487*^9, 3.7809315512095046`*^9}, {
  3.7809316527980003`*^9, 3.780931659724829*^9}, {3.7809318259431343`*^9, 
  3.780931827864333*^9}, {3.780931953475609*^9, 
  3.7809319629409056`*^9}},ExpressionUUID->"1dd672d8-116d-4b65-aaee-\
b38bd74e3dc7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zr3", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l3", " ", "=", " ", 
   RowBox[{"l2", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zl3", "=", " ", 
   RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", "l3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c3", "[", "mul_", "]"}], ":=", 
   RowBox[{"mul", "*", "c2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zc3", "[", "y_", "]"}], " ", ":=", " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", 
      RowBox[{"c3", "[", "y", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mut", "[", "cp_", "]"}], " ", ":=", " ", 
   RowBox[{"cp", "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"l2", "[", 
       RowBox[{"0", ",", "0", ",", "0"}], "]"}], "*", "l3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zLoad", "[", 
    RowBox[{"cpl2_", ",", "z_"}], "]"}], " ", ":=", 
   RowBox[{"serial", "[", 
    RowBox[{
     RowBox[{"serial", "[", 
      RowBox[{"zr2", ",", 
       RowBox[{"zl2", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"\[Omega]", "^", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"mut", "[", "cpl2", "]"}], "^", "2"}], "/", 
       RowBox[{"serial", "[", 
        RowBox[{
         RowBox[{"serial", "[", 
          RowBox[{
           RowBox[{"zc3", "[", "z", "]"}], ",", "zr3"}], "]"}], ",", "zl3"}], 
        "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zCav", "[", 
    RowBox[{"ct_", ",", "coupl_", ",", "mag_"}], "]"}], " ", ":=", " ", 
   RowBox[{"parall", "[", 
    RowBox[{
     RowBox[{"ct", "*", "zc2"}], ",", 
     RowBox[{"zLoad", "[", 
      RowBox[{"coupl", ",", "mag"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7798837466337442`*^9, 3.7798838169072437`*^9}, {
   3.779883850925457*^9, 3.7798840229721775`*^9}, {3.779884091962561*^9, 
   3.779884118899406*^9}, {3.77988426996834*^9, 3.7798842846698613`*^9}, {
   3.7798844461757884`*^9, 3.779884452368213*^9}, {3.7798846115884895`*^9, 
   3.7798846362272034`*^9}, {3.779884958406252*^9, 3.7798849654105396`*^9}, {
   3.779885020002852*^9, 3.779885024894633*^9}, {3.7798854930525312`*^9, 
   3.77988549463103*^9}, {3.779886146633231*^9, 3.77988615869291*^9}, {
   3.779888007108665*^9, 3.7798880329195457`*^9}, {3.7798882281983633`*^9, 
   3.7798882406548023`*^9}, 3.779888800353343*^9, {3.7798890832406044`*^9, 
   3.77988908509879*^9}, 3.7798891649722233`*^9, {3.7798915396071377`*^9, 
   3.7798916231884565`*^9}, {3.779891690687785*^9, 3.7798917288100157`*^9}, {
   3.7798919332337227`*^9, 3.779891934546677*^9}, 3.7798920764346695`*^9, 
   3.7798925235765877`*^9, {3.779893880859389*^9, 3.7798938835104513`*^9}, {
   3.77989397844699*^9, 3.779894072720316*^9}, {3.7798941211892653`*^9, 
   3.7798941991881137`*^9}, {3.779894235040082*^9, 3.7798943083152475`*^9}, {
   3.7798943900674877`*^9, 3.779894428472192*^9}, {3.7799472676193666`*^9, 
   3.779947410252412*^9}, {3.779949496947002*^9, 3.7799495225108957`*^9}, {
   3.7799495542878056`*^9, 3.779949604103481*^9}, {3.77994975959272*^9, 
   3.779949760937197*^9}, {3.7799561981985254`*^9, 3.779956199579486*^9}, {
   3.7799563332795734`*^9, 3.779956335401769*^9}, {3.7799568606007895`*^9, 
   3.779956866558998*^9}, {3.77995719130464*^9, 3.7799571986996346`*^9}, {
   3.779957297775221*^9, 3.7799573592122283`*^9}, {3.7799574099265947`*^9, 
   3.779957412238875*^9}, {3.779957476040608*^9, 3.7799575083378897`*^9}, {
   3.7799575779528565`*^9, 3.779957604757119*^9}, {3.7799576606333456`*^9, 
   3.779957662259742*^9}, {3.7799582466850295`*^9, 3.779958269460349*^9}, {
   3.7799583380945086`*^9, 3.7799584222752504`*^9}, {3.7799584932495103`*^9, 
   3.779958517244618*^9}, {3.7799585790632496`*^9, 3.7799586740163326`*^9}, {
   3.7799587228408513`*^9, 3.77995872455919*^9}, {3.7799590009200644`*^9, 
   3.77995913081147*^9}, {3.7799593170969596`*^9, 3.7799593377751856`*^9}, {
   3.779959513228895*^9, 3.7799595276407037`*^9}, {3.779959621133523*^9, 
   3.779959621935877*^9}, {3.7799597369594665`*^9, 3.7799597744026394`*^9}, 
   3.7799599004413524`*^9, {3.7809312222483034`*^9, 3.7809312387509565`*^9}, {
   3.781116017909916*^9, 3.781116018298998*^9}, {3.7813576498167706`*^9, 
   3.7813576526471815`*^9}, {3.794069144421033*^9, 3.794069165191945*^9}, {
   3.7940694030095425`*^9, 3.794069403359346*^9}, {3.7940694570794353`*^9, 
   3.7940694582887874`*^9}, {3.7940695619683704`*^9, 
   3.7940696153739643`*^9}, {3.79406971907113*^9, 3.7940697831801915`*^9}, {
   3.7940756065692043`*^9, 3.7940756078385224`*^9}, {3.794075685503577*^9, 
   3.7940757000657964`*^9}},ExpressionUUID->"cc62ab6c-22b0-4363-9cc6-\
87465080847c"],

Cell[TextData[{
 StyleBox["Option 2",
  FontColor->RGBColor[1, 0, 0]],
 ": Import susceptibilities as a struct:"
}], "Text",
 CellChangeTimes->{{3.780931691035421*^9, 3.7809317264588923`*^9}, {
  3.7809318304422026`*^9, 
  3.78093183387609*^9}},ExpressionUUID->"b6d1eaf5-30c5-484f-994a-\
be41d80c0ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"address", " ", "=", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "address", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"susc", " ", "=", " ", 
   RowBox[{"Import", "[", "\"\<x1z_x2z_200mK.mat\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"B0", " ", "=", " ", 
   RowBox[{"susc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freq", " ", "=", " ", 
   RowBox[{"susc", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "=", " ", 
   RowBox[{"susc", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", " ", "=", " ", 
   RowBox[{"susc", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7812533331829023`*^9, 3.7812533394690294`*^9}, 
   3.7812533807097907`*^9, {3.7812534425338507`*^9, 3.781253445195706*^9}, {
   3.7812535279725275`*^9, 3.781253589138355*^9}, 3.7813302156274586`*^9, {
   3.794078951164377*^9, 3.7940789549143243`*^9}, {3.794079038487509*^9, 
   3.79407904194658*^9}, {3.7940799181905556`*^9, 3.794079928992835*^9}, {
   3.7940802143508415`*^9, 3.7940802167542205`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"b7276f68-afa4-4aa8-b4b5-2ba514a978ca"],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{"x1", ",", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "B0", "]"}], ",", 
        RowBox[{"Max", "[", "B0", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "freq", "]"}], ",", 
        RowBox[{"Max", "[", "freq", "]"}]}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.781026048950946*^9, 3.781026070662059*^9}, {
  3.7810648269560413`*^9, 3.781064838811563*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"ab8acc05-afd9-4c23-a8d9-203b269d731f"],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Log", "[", "x2", "]"}], ",", " ", 
   RowBox[{"DataRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "B0", "]"}], ",", 
        RowBox[{"Max", "[", "B0", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "freq", "]"}], ",", 
        RowBox[{"Max", "[", "freq", "]"}]}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7809275542127843`*^9, 3.7809276088047924`*^9}, {
  3.7809284934249015`*^9, 3.780928494018507*^9}, {3.7809285260506105`*^9, 
  3.780928576266047*^9}, {3.7809289317573323`*^9, 3.7809289320070553`*^9}, {
  3.780929454711896*^9, 3.780929461741745*^9}, {3.7809309353120584`*^9, 
  3.7809309515580873`*^9}, {3.780941034649*^9, 3.7809410421941876`*^9}, {
  3.780942722291874*^9, 3.7809427426779385`*^9}, {3.7810258648290377`*^9, 
  3.781025909614303*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1279c2e4-6f8e-43a1-9ac2-3e01f00f9feb"],

Cell["\<\
Use interpolation to define a function that represents the susceptibilities:\
\>", "Text",
 CellChangeTimes->{{3.7809317488325663`*^9, 3.780931777134117*^9}, {
  3.781024414814681*^9, 
  3.781024417203772*^9}},ExpressionUUID->"2754ccbe-ac8d-4c30-89a7-\
7cf130138148"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xReal", " ", "=", " ", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "x1", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Min", "[", "B0", "]"}], ",", 
         RowBox[{"Max", "[", "B0", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "B0", "]"}], "-", 
            RowBox[{"Min", "[", "B0", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "B0", "]"}], "\[LeftDoubleBracket]", 
             "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
       ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Min", "[", "freq", "]"}], ",", 
         RowBox[{"Max", "[", "freq", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "freq", "]"}], "-", 
            RowBox[{"Min", "[", "freq", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "freq", "]"}], "\[LeftDoubleBracket]",
              "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"xImg", " ", "=", " ", 
   RowBox[{"ListInterpolation", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "x2", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Min", "[", "B0", "]"}], ",", 
         RowBox[{"Max", "[", "B0", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "B0", "]"}], "-", 
            RowBox[{"Min", "[", "B0", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "B0", "]"}], "\[LeftDoubleBracket]", 
             "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
       ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Min", "[", "freq", "]"}], ",", 
         RowBox[{"Max", "[", "freq", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "freq", "]"}], "-", 
            RowBox[{"Min", "[", "freq", "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "freq", "]"}], "\[LeftDoubleBracket]",
              "2", "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7809286499413786`*^9, 3.780928694242096*^9}, {
   3.7809287495053654`*^9, 3.780928752474139*^9}, {3.780928883201446*^9, 
   3.780928885519375*^9}, {3.780929512621459*^9, 3.7809295199622407`*^9}, 
   3.7809296166642694`*^9, {3.780929765849989*^9, 3.780929770894663*^9}, {
   3.7809298277023597`*^9, 3.7809298706726227`*^9}, {3.7809299243475037`*^9, 
   3.780929926340969*^9}, {3.7809831573344965`*^9, 3.7809831658727922`*^9}, {
   3.7809832250675383`*^9, 3.7809832338600616`*^9}, {3.780983295227386*^9, 
   3.7809833101139584`*^9}, {3.780983387507016*^9, 3.7809834591608114`*^9}, {
   3.7809835252760935`*^9, 3.78098353143426*^9}, {3.7809835888406296`*^9, 
   3.780983615365638*^9}, {3.7809837360854855`*^9, 3.7809837487869415`*^9}, {
   3.780983803965252*^9, 3.780983855933123*^9}, {3.780988451877334*^9, 
   3.780988495582197*^9}, {3.781024428273587*^9, 3.78102443445061*^9}, {
   3.781024510256628*^9, 3.781024517575346*^9}, {3.781024741884473*^9, 
   3.78102476548507*^9}, {3.781024820816909*^9, 3.781024833583658*^9}, {
   3.7810249676647453`*^9, 3.781024990722661*^9}, {3.781025053712034*^9, 
   3.7810251163454227`*^9}, {3.781025231093416*^9, 3.781025409239744*^9}, {
   3.781025564210195*^9, 3.78102568774087*^9}, {3.781025928287969*^9, 
   3.781026000285672*^9}, {3.781026091945603*^9, 3.7810261033059597`*^9}, {
   3.7810261374718637`*^9, 3.781026143287381*^9}, {3.78102655344487*^9, 
   3.781026588656266*^9}, {3.781026716184732*^9, 3.781026721863473*^9}, {
   3.781064848987645*^9, 3.7810648518936787`*^9}, {3.781064915934855*^9, 
   3.781064977548443*^9}, {3.781065016995055*^9, 3.781065018099699*^9}, {
   3.7810653211955013`*^9, 3.781065326235952*^9}, {3.781065409750362*^9, 
   3.781065497791657*^9}, {3.781065579057206*^9, 3.781065636346315*^9}, {
   3.781065699225391*^9, 3.781065761873204*^9}, {3.781067354592701*^9, 
   3.7810673583192673`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"49865129-b405-4a15-9210-01f5cba1ca67"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"xReal", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
   RowBox[{"ClippingStyle", "\[Rule]", "Red"}], ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.781026020864583*^9, 3.781026040475032*^9}, {
   3.781026708222231*^9, 3.7810267105165*^9}, 3.7814320025349813`*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"0672f6d4-86d5-4b26-9d25-9d5d36d2c152"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"xImg", "[", 
     RowBox[{"x", ",", " ", "y"}], "]"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", "0", ",", " ", "9"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"y", ",", " ", "1", ",", " ", "5"}], "}"}], ",", " ", 
   RowBox[{"Mesh", " ", "->", " ", "None"}], ",", " ", 
   RowBox[{"ClippingStyle", " ", "->", " ", "Red"}], ",", " ", "\n", "  ", 
   RowBox[{"WorkingPrecision", " ", "->", " ", "MachinePrecision"}], ",", " ", 
   RowBox[{"PlotPoints", " ", "->", " ", "100"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.781023533889473*^9, 3.781023608302807*^9}, {
   3.781023731994707*^9, 3.781023734324009*^9}, {3.781024530764907*^9, 
   3.7810245514696093`*^9}, {3.7810246236156883`*^9, 3.781024660461156*^9}, {
   3.781024776284973*^9, 3.781024809748536*^9}, {3.781024847006235*^9, 
   3.7810248477162647`*^9}, {3.781025033524021*^9, 3.781025042020015*^9}, {
   3.78102512253724*^9, 3.7810251276918716`*^9}, {3.78102595020208*^9, 
   3.7810260126904373`*^9}, {3.781026702932721*^9, 3.7810267045914793`*^9}, {
   3.781064865854034*^9, 3.78106492792723*^9}, {3.781065504550027*^9, 
   3.781065506520162*^9}, {3.781066033906196*^9, 3.7810660401206627`*^9}, {
   3.7810661021789417`*^9, 3.781066109681913*^9}, {3.7810661419157743`*^9, 
   3.78106614235839*^9}, {3.7810661969457283`*^9, 3.781066199218113*^9}, {
   3.781066275837266*^9, 3.7810663013541937`*^9}, {3.7810663693312683`*^9, 
   3.781066384466311*^9}, {3.781066472940731*^9, 3.781066476510853*^9}, {
   3.781066641543977*^9, 3.7810666494680157`*^9}, 3.7940716633826513`*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"b6bbc087-3130-49e4-b9e4-2252c10150b1"],

Cell[TextData[{
 StyleBox["Interactive plot 1",
  FontColor->RGBColor[1, 0, 0]],
 ": Fixed coupling strength, adjustable cavity frequency through tuning and \
matching capacitors."
}], "Text",
 CellChangeTimes->{{3.781256396710084*^9, 
  3.7812564311875744`*^9}},ExpressionUUID->"26670f44-7bf3-49b1-982f-\
302678688e20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"parall", " ", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "/", "a"}], "+", 
      RowBox[{"1", "/", "b"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"serial", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"a", " ", "+", " ", "b"}]}], ";"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"9910f399-b2e3-4876-bef2-861373577bac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f0", " ", "=", " ", "3.6*^9"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]0", " ", "=", " ", "8.854*^-12"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rT", " ", "=", " ", 
   RowBox[{"0.3", "*", "1.2*^-2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sT", " ", "=", " ", 
   RowBox[{"\[Pi]", "*", 
    RowBox[{"rT", "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gap", " ", "=", " ", "0.2*^-3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", " ", "=", " ", 
   RowBox[{"\[Epsilon]0", "*", 
    RowBox[{"sT", "/", "gap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zc2", "=", " ", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", "c2"}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7940716322166452`*^9, 3.794071679456334*^9}, {
  3.7940717144264174`*^9, 3.7940717204739904`*^9}, {3.7940719076733885`*^9, 
  3.794071907973735*^9}, {3.7940719759471245`*^9, 3.7940719972614717`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"496ffbbd-9ba8-404e-a6d2-58fbd97bd3a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"l2", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "cpl_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.0", "+", 
      RowBox[{"cpl", "*", 
       RowBox[{"(", 
        RowBox[{"x1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "x2"}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f0", "^", "2"}], "*", "c2"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zl2", "[", 
    RowBox[{"y1_", ",", "y2_", ",", "cpl1_"}], "]"}], " ", ":=", " ", 
   RowBox[{"\[ImaginaryI]", "*", "\[Omega]", "*", 
    RowBox[{"l2", "[", 
     RowBox[{"y1", ",", "y2", ",", "cpl1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qFactor", " ", "=", " ", "5000."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zr2", " ", "=", " ", 
   RowBox[{"f0", "*", 
    RowBox[{
     RowBox[{"l2", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}], "/", "qFactor"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zIn", " ", "=", "zr1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zOut", "[", 
    RowBox[{"B_", ",", "p_", ",", "m_", ",", "cpl2_"}], "]"}], ":=", 
   RowBox[{"serial", "[", 
    RowBox[{
     RowBox[{"m", "*", "zc1"}], ",", 
     RowBox[{"parall", "[", 
      RowBox[{
       RowBox[{"p", "*", "zc2"}], ",", 
       RowBox[{"serial", "[", 
        RowBox[{"zr2", ",", 
         RowBox[{"zl2", "[", 
          RowBox[{
           RowBox[{"xReal", "[", 
            RowBox[{"B", ",", 
             RowBox[{"\[Omega]", "/", "1*^9"}]}], "]"}], ",", 
           RowBox[{"xImg", "[", 
            RowBox[{"B", ",", 
             RowBox[{"\[Omega]", "/", "1*^9"}]}], "]"}], ",", "cpl2"}], 
          "]"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7940672554887977`*^9, 3.7940673006628885`*^9}, {
   3.7940673840297394`*^9, 3.7940674281139746`*^9}, {3.7940674697886963`*^9, 
   3.794067478097438*^9}, {3.794067518131447*^9, 3.7940675941300535`*^9}, {
   3.7940682187996054`*^9, 3.7940682276295643`*^9}, {3.794068289980527*^9, 
   3.7940682910007544`*^9}, {3.794068461389594*^9, 3.7940684616030235`*^9}, {
   3.7940699185712748`*^9, 3.7940699188617477`*^9}, {3.7940699932410946`*^9, 
   3.7940700100220876`*^9}, {3.7940700951481123`*^9, 
   3.7940701294400225`*^9}, {3.7940707314327364`*^9, 3.794070757069078*^9}, {
   3.7940708007099533`*^9, 3.7940708413369894`*^9}, {3.7940711427818637`*^9, 
   3.79407115144722*^9}, {3.7940717741858845`*^9, 3.7940717751353807`*^9}, {
   3.7940718111274195`*^9, 3.7940718113372536`*^9}, {3.794071993192917*^9, 
   3.7940719940731735`*^9}, {3.794072065134817*^9, 3.7940720654346356`*^9}, 
   3.7940721363400884`*^9, {3.794072168534608*^9, 3.794072249933342*^9}, {
   3.7940724648756123`*^9, 3.7940724666753964`*^9}, {3.794072630890234*^9, 
   3.794072633129053*^9}, {3.7940727777441874`*^9, 3.7940727862796316`*^9}, {
   3.7945914922482214`*^9, 3.7945915174280186`*^9}, {3.7945915531680584`*^9, 
   3.794591554037595*^9}, {3.79459281479618*^9, 3.79459281516595*^9}, {
   3.7951061899380918`*^9, 3.795106199831616*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"25b4731a-f529-425b-9bc8-ded68e6b51f3"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"zOut", "[", 
          RowBox[{"B", ",", "p", ",", "m", ",", "cpl"}], "]"}], ")"}], "-", 
        RowBox[{"zIn", "/", 
         RowBox[{"(", 
          RowBox[{"zIn", "+", 
           RowBox[{"zOut", "[", 
            RowBox[{"B", ",", "p", ",", "m", ",", "cpl"}], "]"}]}], ")"}]}]}],
        "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"B", ",", "0", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "3.61*^9", ",", "3.67*^9"}], "}"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Magnetic", " ", "field"}], ",", "Frequency"}], "}"}]}], ",", 
     " ", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"BarLegend", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<TemperatureMap\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"cMin", ",", "cMax"}], "}"}]}], "}"}], "]"}]}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<S11 of LC circuits\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", " ", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "[", 
       RowBox[{"Gray", ",", " ", "0.85"}], "]"}]}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
         RowBox[{"Rescale", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"cMin", ",", "cMax"}], "}"}]}], "]"}], "]"}], "&"}], 
       ")"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "1.03", ",", "\"\<Tuning capacitor\>\""}], "}"}], ",",
      "0.1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1.0", ",", "\"\<Matching capacitor\>\""}], "}"}], 
     ",", "1", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cMin", ",", "0.5", ",", "\"\<Color range\>\""}], "}"}], ",", 
     "0.0", ",", "0.99"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cMax", ",", "1.0", ",", "\"\<Color range\>\""}], "}"}], ",", 
     "0.1", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cpl", ",", "0.000", ",", "\"\<Coupling strength\>\""}], "}"}], 
     ",", "0", ",", "0.5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.779713702089882*^9, 3.7797137196426783`*^9}, {
   3.7797141033447485`*^9, 3.779714175478293*^9}, {3.779714227727275*^9, 
   3.779714307006169*^9}, {3.779714339151318*^9, 3.7797143553138127`*^9}, {
   3.7797146051510344`*^9, 3.779714621477318*^9}, {3.7797147434033384`*^9, 
   3.7797147683051925`*^9}, {3.7797148879456005`*^9, 3.779714952807516*^9}, {
   3.779715036704135*^9, 3.779715046295513*^9}, {3.7798844059136114`*^9, 
   3.7798844104209003`*^9}, {3.7798922372405357`*^9, 
   3.7798922373811135`*^9}, {3.779892309641733*^9, 3.779892337732989*^9}, {
   3.7798924304885426`*^9, 3.779892446040316*^9}, {3.7809408388011684`*^9, 
   3.7809408391597166`*^9}, {3.7809408770782776`*^9, 3.780940903295675*^9}, {
   3.7809410576286726`*^9, 3.7809410589253063`*^9}, 3.780941158210469*^9, {
   3.780941504451829*^9, 3.780941510934846*^9}, {3.780941752069162*^9, 
   3.7809418451514072`*^9}, {3.781026162109004*^9, 3.7810261752009487`*^9}, {
   3.7810262246752377`*^9, 3.7810262334264317`*^9}, {3.781026297759358*^9, 
   3.7810263247647247`*^9}, {3.781066755010325*^9, 3.781066760729969*^9}, {
   3.78106679705313*^9, 3.781066797835246*^9}, {3.7810668415635967`*^9, 
   3.781066842113308*^9}, {3.78106695024201*^9, 3.781066972905283*^9}, {
   3.781116090412355*^9, 3.78111615195467*^9}, {3.781116294553235*^9, 
   3.7811162965967693`*^9}, {3.7811163640608273`*^9, 3.781116364369629*^9}, {
   3.781116474153441*^9, 3.781116480471809*^9}, {3.781116520096796*^9, 
   3.78111652281754*^9}, 3.781116597138*^9, {3.781116675598218*^9, 
   3.781116675920865*^9}, {3.781116861660892*^9, 3.781116870897934*^9}, {
   3.781116913713901*^9, 3.7811169316261044`*^9}, {3.781116978555521*^9, 
   3.7811169862716846`*^9}, {3.781117713403735*^9, 3.7811177136463118`*^9}, {
   3.781253788795519*^9, 3.781253794616897*^9}, {3.7812539516644335`*^9, 
   3.7812539520404253`*^9}, {3.781255053870992*^9, 3.7812550543896008`*^9}, {
   3.7812553366045113`*^9, 3.7812553462187476`*^9}, {3.7812555601139927`*^9, 
   3.7812556462329645`*^9}, {3.7812561637020254`*^9, 3.781256171437233*^9}, {
   3.781332278132881*^9, 3.781332291206854*^9}, {3.781332407237167*^9, 
   3.781332417038893*^9}, {3.7813324574957647`*^9, 3.781332465078046*^9}, {
   3.7813551285232663`*^9, 3.7813551335557814`*^9}, {3.7813552118841467`*^9, 
   3.781355222765663*^9}, {3.7813554161793985`*^9, 3.78135541952347*^9}, {
   3.7813559954278984`*^9, 3.7813560128202686`*^9}, {3.781356068430094*^9, 
   3.781356106829153*^9}, 3.7813561406444645`*^9, 3.781356174504654*^9, {
   3.781356540206932*^9, 3.7813565553144693`*^9}, {3.7816364550380707`*^9, 
   3.781636511918212*^9}, {3.781636685772274*^9, 3.7816366998116903`*^9}, {
   3.7816367672842283`*^9, 3.781636782323338*^9}, 3.781636896217802*^9, {
   3.7940621850072956`*^9, 3.794062189363445*^9}, {3.794067630378696*^9, 
   3.794067684938596*^9}, {3.7940683555405316`*^9, 3.794068359373237*^9}, {
   3.7940709051592426`*^9, 3.794070924485962*^9}, {3.794071228832877*^9, 
   3.7940712352894363`*^9}, 3.794072157289869*^9, {3.7940723255550036`*^9, 
   3.7940723494548416`*^9}, {3.79407255641988*^9, 3.794072566371892*^9}, {
   3.794072792159723*^9, 3.794072837879586*^9}, {3.7940733598196983`*^9, 
   3.7940733994199963`*^9}, {3.7940734854106383`*^9, 3.794073492917301*^9}, {
   3.794073721247941*^9, 3.794073759169443*^9}, {3.794073819823499*^9, 
   3.7940738243303857`*^9}, {3.7940739491431475`*^9, 
   3.7940739866922045`*^9}, {3.794077886782275*^9, 3.794077889180996*^9}, {
   3.794077999858827*^9, 3.794078008773857*^9}, {3.794078061335518*^9, 
   3.7940780651642184`*^9}, {3.7940781721144233`*^9, 3.794078179400529*^9}, {
   3.794078264880503*^9, 3.7940782668894305`*^9}, {3.7940784786434407`*^9, 
   3.794078498023115*^9}, {3.7940788003171587`*^9, 3.794078815197176*^9}, {
   3.794591531590476*^9, 3.794591544631232*^9}, {3.794591579472702*^9, 
   3.794591610220834*^9}, {3.794591766992318*^9, 3.7945917689812584`*^9}, {
   3.7945918775805197`*^9, 3.794591915762244*^9}, {3.7945921710130806`*^9, 
   3.7945921880397844`*^9}, {3.794592510845166*^9, 3.794592521930015*^9}, {
   3.794592714352356*^9, 3.7945927252670474`*^9}, {3.794592821691918*^9, 
   3.794592826438859*^9}, {3.7945929064777756`*^9, 3.794592917959834*^9}, {
   3.794592999199031*^9, 3.794593008694347*^9}, {3.7945937875917807`*^9, 
   3.7945938083300924`*^9}, {3.794594076488768*^9, 3.794594101500083*^9}, {
   3.7945941976358194`*^9, 3.7945942383674927`*^9}, {3.7945955085673866`*^9, 
   3.794595515404724*^9}, {3.7945956665379605`*^9, 3.794595691596635*^9}, {
   3.7946602532483454`*^9, 3.7946602650238647`*^9}, {3.7946605633593454`*^9, 
   3.794660563887933*^9}, {3.795104122418215*^9, 3.7951041226884575`*^9}, {
   3.7951046817664723`*^9, 3.7951046871080236`*^9}, {3.7951054250681953`*^9, 
   3.7951054271875196`*^9}, {3.7951057188482995`*^9, 
   3.7951057477953744`*^9}, {3.7951057927779336`*^9, 
   3.7951057933823557`*^9}, {3.795105854531156*^9, 3.7951058547545586`*^9}, {
   3.7951064267674704`*^9, 3.7951064336620674`*^9}, {3.7951064772010593`*^9, 
   3.795106488772148*^9}, {3.7951068556886744`*^9, 3.7951068592102985`*^9}, {
   3.795107706122435*^9, 3.7951077095193133`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"741ca69d-042b-4eed-b08e-03a46ea4b819"],

Cell["\<\
Plot the impedance at different frequencies between serial and parallel \
circuits\
\>", "Text",
 CellChangeTimes->{{3.7812592486233163`*^9, 
  3.7812592849559555`*^9}},ExpressionUUID->"38b926a0-a09c-4494-bf8a-\
fb8e6137f42f"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"parall", "[", 
       RowBox[{"zc2", ",", 
        RowBox[{"serial", "[", 
         RowBox[{"zr2", ",", 
          RowBox[{"zl2", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{"serial", "[", 
       RowBox[{"zr2", ",", 
        RowBox[{"serial", "[", 
         RowBox[{"zc2", ",", 
          RowBox[{"zl2", "[", 
           RowBox[{"0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", "1*^9", ",", "10*^9"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Frequency", ",", "Impedance"}], "}"}]}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Parallel LC\>\"", ",", "\"\<Serial LC\>\""}], "}"}]}], ",", 
   " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Impedence of LC circuits\>\""}], ",", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
   RowBox[{"Background", "\[Rule]", 
    RowBox[{"Lighter", "[", 
     RowBox[{"Gray", ",", " ", "0.85"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7795394368156586`*^9, 3.7795394948803825`*^9}, {
  3.7795396034264135`*^9, 3.779539605957222*^9}, {3.7795397438828754`*^9, 
  3.779539791413605*^9}, {3.7795403255532713`*^9, 3.779540330036558*^9}, {
  3.7795406988045425`*^9, 3.7795407070742235`*^9}, {3.7795407429735146`*^9, 
  3.7795407467692027`*^9}, {3.7795407887678337`*^9, 3.7795408426687126`*^9}, {
  3.7795410400039234`*^9, 3.779541112735837*^9}, {3.7795411536957483`*^9, 
  3.7795411775273724`*^9}, {3.7795412142461*^9, 3.7795412456249714`*^9}, {
  3.7795412884166355`*^9, 3.7795413591477847`*^9}, {3.77954141382305*^9, 
  3.7795414301287427`*^9}, {3.7795414675632825`*^9, 3.7795415467273345`*^9}, {
  3.779550278027626*^9, 3.779550278175706*^9}, {3.7795515108488927`*^9, 
  3.779551539022339*^9}, {3.7796952098212295`*^9, 3.779695265603815*^9}, {
  3.779699562041133*^9, 3.779699567946686*^9}, {3.7796998538370123`*^9, 
  3.7796998541930447`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"f6fdc100-49c4-411e-aba3-052feb7209b8"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zl1", "[", 
             RowBox[{"n", ",", "\[Omega]"}], "]"}]}], "]"}], "-", 
          RowBox[{"serial", "[", 
           RowBox[{"zr2", ",", 
            RowBox[{"serial", "[", 
             RowBox[{"zc2", ",", 
              RowBox[{"zl2", "[", 
               RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zl1", "[", 
             RowBox[{"n", ",", "\[Omega]"}], "]"}]}], "]"}], "+", 
          RowBox[{"serial", "[", 
           RowBox[{"zr2", ",", 
            RowBox[{"serial", "[", 
             RowBox[{"zc2", ",", 
              RowBox[{"zl2", "[", 
               RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]}], "]"}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "1*^9", ",", "6*^9"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Frequency", ",", "S11"}], "}"}]}], ",", " ", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Parallel LCs\>\"", ",", "\"\<Serial LCs\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<S11 of LC circuits\>\""}], ",", 
     RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}], ",", " ", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "[", 
       RowBox[{"Gray", ",", " ", "0.85"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "0.5", ",", "\"\<Inductor multiplier\>\""}], "}"}], 
     ",", "0.001", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7796060485601835`*^9, 3.7796062072141266`*^9}, {
   3.7796062901509686`*^9, 3.77960629076015*^9}, {3.779614510170792*^9, 
   3.779614516009129*^9}, 3.7796158192137213`*^9, 3.779615933229556*^9, {
   3.7796160458985806`*^9, 3.779616050679445*^9}, {3.7796164430303307`*^9, 
   3.779616458185337*^9}, {3.779616570269014*^9, 3.7796165722682076`*^9}, {
   3.7796166098137593`*^9, 3.7796166113751125`*^9}, {3.77962594188955*^9, 
   3.7796259442978363`*^9}, {3.77962702542229*^9, 3.779627055966362*^9}, {
   3.7796272323690386`*^9, 3.7796272709781017`*^9}, {3.779627387589241*^9, 
   3.7796274744063663`*^9}, {3.7796275119230704`*^9, 3.77962757880863*^9}, {
   3.7796345325188723`*^9, 3.7796345732102966`*^9}, {3.779694890803031*^9, 
   3.779695083065998*^9}, {3.7796992641873407`*^9, 3.779699350477598*^9}, {
   3.77969940552411*^9, 3.7796994711783876`*^9}, {3.7797023474770465`*^9, 
   3.779702366741251*^9}, {3.779705329556432*^9, 3.77970533186838*^9}, {
   3.779705366160536*^9, 3.7797054459472694`*^9}, {3.7797054986823254`*^9, 
   3.7797054994473457`*^9}, {3.7797134667994957`*^9, 
   3.7797135411968546`*^9}, {3.7809407348515005`*^9, 3.7809407387419205`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c7b8a66b-5e17-4767-aead-ae932a65cc08"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zc1", "[", 
             RowBox[{"m", ",", "\[Omega]"}], "]"}]}], "]"}], "-", 
          RowBox[{"parall", "[", 
           RowBox[{
            RowBox[{"p", "*", "zc2"}], ",", 
            RowBox[{"serial", "[", 
             RowBox[{"zr2", ",", 
              RowBox[{"zl2", "[", 
               RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]}], "]"}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zc1", "[", 
             RowBox[{"m", ",", "\[Omega]"}], "]"}]}], "]"}], "+", 
          RowBox[{"parall", "[", 
           RowBox[{
            RowBox[{"p", "*", "zc2"}], ",", 
            RowBox[{"serial", "[", 
             RowBox[{"zr2", ",", 
              RowBox[{"zl2", "[", 
               RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]}], "]"}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "1*^9", ",", "6*^9"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Frequency", ",", "S11"}], "}"}]}], ",", " ", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Parallel LCs\>\"", ",", "\"\<Serial LCs\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<S11 of LC circuits\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "[", 
       RowBox[{"Gray", ",", " ", "0.85"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "0", ",", "\"\<Real susceptibility\>\""}], "}"}], 
     ",", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", "0", ",", "\"\<Imaginary susceptibility\>\""}], 
      "}"}], ",", "0.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "1.2", ",", "\"\<Tuning capacitor\>\""}], "}"}], ",", 
     "0.1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "0.1", ",", "\"\<Matching capacitor\>\""}], "}"}], 
     ",", "0.001", ",", "0.1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7796060485601835`*^9, 3.7796062072141266`*^9}, {
   3.7796062901509686`*^9, 3.77960629076015*^9}, {3.779614510170792*^9, 
   3.779614516009129*^9}, 3.7796158192137213`*^9, 3.779615933229556*^9, {
   3.7796160458985806`*^9, 3.779616050679445*^9}, {3.7796164430303307`*^9, 
   3.779616458185337*^9}, {3.779616570269014*^9, 3.7796165722682076`*^9}, {
   3.7796166098137593`*^9, 3.7796166113751125`*^9}, {3.77962594188955*^9, 
   3.7796259442978363`*^9}, {3.77962702542229*^9, 3.779627055966362*^9}, {
   3.7796272323690386`*^9, 3.7796272709781017`*^9}, {3.779627387589241*^9, 
   3.7796274744063663`*^9}, {3.7796275119230704`*^9, 3.77962757880863*^9}, {
   3.7796345325188723`*^9, 3.7796345732102966`*^9}, {3.779634612395466*^9, 
   3.779634629516282*^9}, {3.7796346693171577`*^9, 3.779634688052582*^9}, {
   3.7796347531170597`*^9, 3.7796348057051277`*^9}, {3.779634835764181*^9, 
   3.7796348667602596`*^9}, {3.779634918580632*^9, 3.779635045886572*^9}, {
   3.779635119830593*^9, 3.779635140685666*^9}, 3.779641422551532*^9, {
   3.7796938385058155`*^9, 3.779693841149181*^9}, {3.779693966280134*^9, 
   3.7796940623024187`*^9}, {3.779694103565318*^9, 3.7796941318269978`*^9}, 
   3.779694176947115*^9, {3.779694249626246*^9, 3.7796943664607754`*^9}, {
   3.7796944613591805`*^9, 3.779694501708819*^9}, {3.7796945381748066`*^9, 
   3.779694542768309*^9}, {3.7796946095569215`*^9, 3.7796946212906504`*^9}, 
   3.7796946678069057`*^9, {3.779694707896231*^9, 3.7796947086147757`*^9}, {
   3.7796947898981156`*^9, 3.7796948345688934`*^9}, {3.7796951105302124`*^9, 
   3.7796951287967644`*^9}, {3.7796953348236837`*^9, 3.779695372489558*^9}, {
   3.7797024020109587`*^9, 3.7797024175557494`*^9}, {3.7797025649561925`*^9, 
   3.7797025699880533`*^9}, {3.7797030857635136`*^9, 3.779703088626407*^9}, {
   3.779713984435968*^9, 3.779714006811884*^9}, 3.779714043776541*^9, {
   3.77989220507223*^9, 3.779892205258936*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"3799df5b-1d61-43ce-bde8-78ee1ec5d17a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Abs", "[", 
       RowBox[{"zCav", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "1*^9", ",", "6*^9"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "1.0", ",", "\"\<Tunning capacitor\>\""}], "}"}], ",",
      "0.5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "\"\<Coupling strength\>\""}], "}"}], ",", 
     "0.0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "0.3", ",", "\"\<Sample Capacitance\>\""}], "}"}], 
     ",", "0.01", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.779891811020076*^9, 3.7798918186752896`*^9}, {
  3.7798926453284435`*^9, 3.77989264635955*^9}, {3.7798927045158606`*^9, 
  3.7798928689246855`*^9}, {3.7798929595286255`*^9, 3.779892960152726*^9}, {
  3.779893014214196*^9, 3.779893022665*^9}, {3.7798944782188873`*^9, 
  3.779894482518833*^9}, {3.779894513682576*^9, 3.7798945622056265`*^9}, {
  3.7798946806423225`*^9, 3.779894692761329*^9}, {3.779947439709612*^9, 
  3.7799474409373283`*^9}, {3.7799497949016757`*^9, 3.7799498224737544`*^9}, {
  3.779949852995138*^9, 3.779949854067938*^9}, {3.7799498979705925`*^9, 
  3.779949903737281*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"bda1f85f-b137-4d55-ad3a-fcf47263dd05"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"serial", "[", 
         RowBox[{"zr1", ",", 
          RowBox[{"zc1", "[", 
           RowBox[{"0.40", ",", "\[Omega]"}], "]"}]}], "]"}], "-", 
        RowBox[{"zCav", "[", 
         RowBox[{"1.20", ",", "0.1", ",", "k"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"serial", "[", 
         RowBox[{"zr1", ",", 
          RowBox[{"zc1", "[", 
           RowBox[{"0.40", ",", "\[Omega]"}], "]"}]}], "]"}], "+", 
        RowBox[{"zCav", "[", 
         RowBox[{"1.2", ",", "0.1", ",", "k"}], "]"}]}], ")"}]}], "]"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.0", ",", "10.00"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", "1*^9", ",", "6*^9"}], "}"}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Parallel LCs\>\"", ",", "\"\<Serial LCs\>\""}], "}"}]}], 
   ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<S11 of LC circuits\>\""}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Field", " ", "parameter"}], ",", "Frequency"}], "}"}]}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", " ", 
   RowBox[{"Background", "\[Rule]", 
    RowBox[{"Lighter", "[", 
     RowBox[{"Gray", ",", " ", "0.85"}], "]"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<ThermometerColors\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "BarLegend"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7798886145435324`*^9, 3.779888620447693*^9}, {
   3.7798888200142956`*^9, 3.779888820592366*^9}, {3.7798889413176746`*^9, 
   3.77988894194178*^9}, {3.779889597650343*^9, 3.779889621259821*^9}, {
   3.779893081675779*^9, 3.779893090720824*^9}, {3.779893127044773*^9, 
   3.7798931438109264`*^9}, {3.7798932840223784`*^9, 
   3.7798932916929884`*^9}, {3.779893390117882*^9, 3.779893411948678*^9}, {
   3.7798935366313534`*^9, 3.779893547836793*^9}, {3.7798947176218386`*^9, 
   3.779894719897307*^9}, {3.779894751041157*^9, 3.7798947513200974`*^9}, {
   3.779895041388955*^9, 3.779895073038986*^9}, {3.7798955209964175`*^9, 
   3.779895541870593*^9}, {3.7799499210955563`*^9, 3.7799500055086665`*^9}, {
   3.7799501121521807`*^9, 3.779950121977415*^9}, {3.779952553325305*^9, 
   3.7799525667028074`*^9}, {3.7799528920825105`*^9, 3.7799529189465246`*^9}, 
   3.7812537705883837`*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"0262bc42-c8e4-4985-92b6-4b112a78a887"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zc1", "[", 
             RowBox[{"0.40", ",", "\[Omega]"}], "]"}]}], "]"}], "-", 
          RowBox[{"zCav", "[", 
           RowBox[{"tCap", ",", "cpl", ",", "field"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"serial", "[", 
           RowBox[{"zr1", ",", 
            RowBox[{"zc1", "[", 
             RowBox[{"0.40", ",", "\[Omega]"}], "]"}]}], "]"}], "+", 
          RowBox[{"zCav", "[", 
           RowBox[{"tCap", ",", "cpl", ",", "field"}], "]"}]}], ")"}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"field", ",", "0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]", ",", "1*^9", ",", "6*^9"}], "}"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Field", "  ", "Parameter"}], ",", " ", "Frequency"}], 
       "}"}]}], ",", " ", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<S11 of LC circuits\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "col"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"BarLegend", "[", 
       RowBox[{"{", 
        RowBox[{"Full", ",", "Full", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "col"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<ThermometerColors\>\"", "]"}], "[", 
         RowBox[{"Rescale", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "col"}], ",", "0"}], "}"}]}], "]"}], "]"}], "&"}], 
       ")"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "70"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cpl", ",", "0.0", ",", "\"\<Coupling Strength\>\""}], "}"}], 
     ",", "0.0", ",", "1.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tCap", ",", "1.5", ",", "\"\<Tunning Capacitor\>\""}], "}"}], 
     ",", "0.1", ",", "10.0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"col", ",", "80", ",", "\"\<Color Range\>\""}], "}"}], ",", 
     "60", ",", "100"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.779713702089882*^9, 3.7797137196426783`*^9}, {
   3.7797141033447485`*^9, 3.779714175478293*^9}, {3.779714227727275*^9, 
   3.779714307006169*^9}, {3.779714339151318*^9, 3.7797143553138127`*^9}, {
   3.7797146051510344`*^9, 3.779714621477318*^9}, {3.7797147434033384`*^9, 
   3.7797147683051925`*^9}, {3.7797148879456005`*^9, 3.779714952807516*^9}, {
   3.779715036704135*^9, 3.779715046295513*^9}, {3.7798841383286667`*^9, 
   3.7798842163910065`*^9}, {3.779884663996874*^9, 3.7798846665907536`*^9}, {
   3.7798847231915054`*^9, 3.7798847522735243`*^9}, {3.7798847951281967`*^9, 
   3.779884806769885*^9}, {3.779884866767372*^9, 3.7798849079960213`*^9}, {
   3.779885339314726*^9, 3.7798853395649023`*^9}, {3.7798853974532585`*^9, 
   3.7798853987186713`*^9}, {3.77988763333252*^9, 3.7798876543178883`*^9}, {
   3.779887804229603*^9, 3.7798878721319895`*^9}, {3.7798879305822487`*^9, 
   3.7798879371119604`*^9}, {3.779888068836574*^9, 3.779888080849638*^9}, {
   3.7798883429884787`*^9, 3.7798883497053013`*^9}, {3.7798896432327757`*^9, 
   3.77988964349909*^9}, {3.7798913521782804`*^9, 3.7798913719442687`*^9}, {
   3.7798914637197495`*^9, 3.7798914980511084`*^9}, {3.7798933542837873`*^9, 
   3.779893362050419*^9}, {3.7798934294438705`*^9, 3.779893431135425*^9}, {
   3.779894777085714*^9, 3.779894868243797*^9}, {3.77989516076293*^9, 
   3.7798952052553787`*^9}, {3.779895248836094*^9, 3.7798952680517516`*^9}, {
   3.7798953428164997`*^9, 3.7798953434882545`*^9}, {3.779895547284377*^9, 
   3.7798955720429425`*^9}, {3.7798956168525047`*^9, 
   3.7798956491911182`*^9}, {3.779895693133459*^9, 3.7798958040645695`*^9}, {
   3.7798961031615257`*^9, 3.7798961074380827`*^9}, {3.779947158250099*^9, 
   3.7799471587318115`*^9}, {3.7799500190529575`*^9, 
   3.7799500506739173`*^9}, {3.779950594258605*^9, 3.779950669291786*^9}, {
   3.779950700957157*^9, 3.779950701133638*^9}, {3.779950988756934*^9, 
   3.7799509894382935`*^9}, 3.779951063297676*^9, {3.779951204058097*^9, 
   3.779951266615919*^9}, {3.779951315734665*^9, 3.7799513333180995`*^9}, {
   3.7799513936065297`*^9, 3.779951396144538*^9}, {3.7799514462168465`*^9, 
   3.7799514597025414`*^9}, {3.77995151149854*^9, 3.7799515190180902`*^9}, {
   3.77995158367242*^9, 3.7799516628127117`*^9}, {3.779951693916422*^9, 
   3.7799518854475503`*^9}, {3.7799519520246897`*^9, 3.779951972412648*^9}, {
   3.779952042124472*^9, 3.779952042996698*^9}, {3.7799520752808375`*^9, 
   3.7799521038223376`*^9}, {3.77995214679694*^9, 3.779952149269536*^9}, {
   3.77995218657104*^9, 3.7799522302737317`*^9}, {3.7799523596307974`*^9, 
   3.7799523864340954`*^9}, {3.779952435122837*^9, 3.779952441727149*^9}, {
   3.779952473373267*^9, 3.7799524744987545`*^9}, {3.779952517902976*^9, 
   3.779952532001938*^9}, {3.779952613306636*^9, 3.7799526999242573`*^9}, {
   3.7799527706904016`*^9, 3.7799527724556055`*^9}, {3.779952804941127*^9, 
   3.779952806169854*^9}, {3.779952851058341*^9, 3.7799529116956663`*^9}, {
   3.779955855866418*^9, 3.779955860321638*^9}, {3.779955982218353*^9, 
   3.779956014931435*^9}, {3.779956080943602*^9, 3.779956086256708*^9}, {
   3.779956128244887*^9, 3.7799561368434243`*^9}, {3.779956224519633*^9, 
   3.7799562938205695`*^9}, {3.7799563647814665`*^9, 
   3.7799564098700376`*^9}, {3.779956507660929*^9, 3.7799565167885427`*^9}, {
   3.7799566149666967`*^9, 3.7799566810871887`*^9}, {3.779960211204007*^9, 
   3.77996026210262*^9}, {3.779960353650896*^9, 3.7799603870012836`*^9}, {
   3.7799604791223116`*^9, 3.7799604814923673`*^9}, {3.779968519127168*^9, 
   3.7799685193301077`*^9}, {3.779968565421526*^9, 3.779968568826836*^9}, {
   3.7799686456031456`*^9, 3.779968653023263*^9}, {3.7799687340066223`*^9, 
   3.7799687345378137`*^9}, {3.7799687918312993`*^9, 
   3.7799687923153715`*^9}, {3.77996887674144*^9, 3.77996892002146*^9}, {
   3.7799689755482297`*^9, 3.7799689760644526`*^9}, {3.7799690153724413`*^9, 
   3.779969022261718*^9}, {3.779969142615629*^9, 3.7799691432248645`*^9}, {
   3.779969288599985*^9, 3.779969349644335*^9}, {3.7799694037685995`*^9, 
   3.7799694110796328`*^9}, {3.7799694531278973`*^9, 3.779969453534027*^9}, {
   3.7799695888756723`*^9, 3.779969609009568*^9}, {3.7799696475271025`*^9, 
   3.779969657572372*^9}, {3.7800390725611143`*^9, 3.780039074360681*^9}, {
   3.780039651954455*^9, 3.78003965342286*^9}, {3.780051919786187*^9, 
   3.7800519199111633`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ede8c24a-c266-4582-9c11-0e5bef5d6b71"]
},
WindowSize->{1264, 637},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 319, 6, 35, "Input",ExpressionUUID->"1aaf5956-f22c-429a-804b-9e7473360dfa"],
Cell[880, 28, 393, 8, 68, "Text",ExpressionUUID->"2c249f65-39f2-4720-90d4-95848134f364"],
Cell[1276, 38, 6095, 129, 372, "Input",ExpressionUUID->"d7e8d268-3215-4708-8398-92dd7f713a75"],
Cell[7374, 169, 337, 7, 41, "Text",ExpressionUUID->"a9c5f9d1-0a41-4009-92d6-467f5c98d2ad"],
Cell[7714, 178, 2624, 44, 60, "Input",ExpressionUUID->"a0d4ad8a-1959-43b3-8a4e-ed7483be9e23"],
Cell[10341, 224, 277, 6, 41, "Text",ExpressionUUID->"4ca677c2-df57-43bc-829c-35d48b2b858b"],
Cell[10621, 232, 994, 22, 60, "Input",ExpressionUUID->"b8c419ec-bd6d-4d5c-ae2b-cbb7c2f853d9"],
Cell[11618, 256, 508, 10, 41, "Text",ExpressionUUID->"1dd672d8-116d-4b65-aaee-b38bd74e3dc7"],
Cell[12129, 268, 4942, 101, 204, "Input",ExpressionUUID->"cc62ab6c-22b0-4363-9cc6-87465080847c"],
Cell[17074, 371, 302, 8, 41, "Text",ExpressionUUID->"b6d1eaf5-30c5-484f-994a-be41d80c0ba8"],
Cell[17379, 381, 1438, 31, 180, "Input",ExpressionUUID->"b7276f68-afa4-4aa8-b4b5-2ba514a978ca"],
Cell[18820, 414, 642, 17, 35, "Input",ExpressionUUID->"ab8acc05-afd9-4c23-a8d9-203b269d731f"],
Cell[19465, 433, 1032, 23, 35, "Input",ExpressionUUID->"1279c2e4-6f8e-43a1-9ac2-3e01f00f9feb"],
Cell[20500, 458, 277, 6, 41, "Text",ExpressionUUID->"2754ccbe-ac8d-4c30-89a7-7cf130138148"],
Cell[20780, 466, 4871, 107, 156, "Input",ExpressionUUID->"49865129-b405-4a15-9210-01f5cba1ca67"],
Cell[25654, 575, 711, 15, 60, "Input",ExpressionUUID->"0672f6d4-86d5-4b26-9d25-9d5d36d2c152"],
Cell[26368, 592, 1730, 28, 60, "Input",ExpressionUUID->"b6bbc087-3130-49e4-b9e4-2252c10150b1"],
Cell[28101, 622, 320, 8, 41, "Text",ExpressionUUID->"26670f44-7bf3-49b1-982f-302678688e20"],
Cell[28424, 632, 518, 15, 60, "Input",ExpressionUUID->"9910f399-b2e3-4876-bef2-861373577bac"],
Cell[28945, 649, 1164, 31, 180, "Input",ExpressionUUID->"496ffbbd-9ba8-404e-a6d2-58fbd97bd3a9"],
Cell[30112, 682, 3211, 73, 156, "Input",ExpressionUUID->"25b4731a-f529-425b-9bc8-ded68e6b51f3"],
Cell[33326, 757, 7847, 143, 156, "Input",ExpressionUUID->"741ca69d-042b-4eed-b08e-03a46ea4b819"],
Cell[41176, 902, 236, 6, 41, "Text",ExpressionUUID->"38b926a0-a09c-4494-bf8a-fb8e6137f42f"],
Cell[41415, 910, 2232, 47, 84, "Input",ExpressionUUID->"f6fdc100-49c4-411e-aba3-052feb7209b8"],
Cell[43650, 959, 3182, 69, 156, "Input",ExpressionUUID->"c7b8a66b-5e17-4767-aead-ae932a65cc08"],
Cell[46835, 1030, 4524, 97, 180, "Input",ExpressionUUID->"3799df5b-1d61-43ce-bde8-78ee1ec5d17a"],
Cell[51362, 1129, 1589, 36, 60, "Input",ExpressionUUID->"bda1f85f-b137-4d55-ad3a-fcf47263dd05"],
Cell[52954, 1167, 2615, 57, 108, "Input",ExpressionUUID->"0262bc42-c8e4-4985-92b6-4b112a78a887"],
Cell[55572, 1226, 7204, 136, 156, "Input",ExpressionUUID->"ede8c24a-c266-4582-9c11-0e5bef5d6b71"]
}
]
*)

